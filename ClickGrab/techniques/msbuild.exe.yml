name: msbuild.exe
added_at: 2025-09-09
platform: windows
presentation: cli
info: >
  `msbuild.exe` is Microsoft's build engine for .NET and Visual Studio projects. It processes XML project files 
  to coordinate the building of applications. Attackers can abuse msbuild.exe to execute malicious code by 
  creating specially crafted XML project files that contain inline C# or other .NET code.
lures:
  - nickname: "Fix Windows Media Player"
    added_at: "2025-09-09"
    contributor:
      name: "Michael Haag"
      handle: "M_haggis"
      contacts:
        twitter: "M_haggis"
    preamble: >
      Your Windows Media Player components need to be repaired. Follow these steps to fix playback issues:
    steps:
      - "Press **Win-R** on your keyboard"
      - "Type **`msbuild`** and press **Enter**"
      - "Press **Ctrl-V** to paste the repair configuration"
      - "Press **Enter** to execute"
    capabilities:
      - MOTW
    references:
      - "https://www.microsoft.com/en-us/security/blog/2025/08/21/think-before-you-clickfix-analyzing-the-clickfix-social-engineering-technique/"
    mitigations:
      - "Restrict msbuild.exe execution through application control"
      - "Monitor for suspicious msbuild.exe command lines"
      - "Never run commands from untrusted sources"
      - "Be suspicious of requests to fix media components via command line"
  - nickname: "Update .NET Framework"
    added_at: "2025-09-09"
    contributor:
      name: "Michael Haag"
      handle: "M_haggis"
      contacts:
        twitter: "M_haggis"
    preamble: >
      Your .NET Framework needs critical updates. Apply this fix to ensure proper application functionality:
    steps:
      - "Press **Win** on your keyboard"
      - "Type **`msbuild`** and press **Ctrl+Shift+Enter**"
      - "Click **Yes** when prompted"
      - "Press **Ctrl-V** to paste the update configuration"
      - "Press **Enter** to execute"
    capabilities:
      - UAC
    references:
      - "https://www.microsoft.com/en-us/security/blog/2025/08/21/think-before-you-clickfix-analyzing-the-clickfix-social-engineering-technique/"
    mitigations:
      - "Restrict msbuild.exe execution through application control"
      - "Monitor for suspicious msbuild.exe command lines"
      - "Never run commands from untrusted sources"
      - "Always update .NET Framework through Windows Update or official Microsoft installers"
